([English](../README.md) / 日本語)

# Explorer Ghost Cleaner

[![License](https://img.shields.io/badge/license-MIT%2FApache--2.0-blue.svg)](#ライセンス)
[![Rust](https://img.shields.io/badge/language-Rust-orange.svg)](https://rust-lang.org/ja/)
[![Platform](https://img.shields.io/badge/platform-Windows-blue)](#動作要件)

「ゴースト」化した `explorer.exe` プロセスを自動的にクリーンアップする、軽量な Windows システムトレイ アプリケーションです。

Windows の設定で「別のプロセスでフォルダー ウィンドウを開く」を有効にしている場合、すべてのウィンドウを閉じた後でも、アイドル状態のエクスプローラー プロセスがメモリに残ってしまうことがあります。このツールは、これらのアイドル プロセスを検出・終了させ、システム リソースを解放します。

## 特徴

* **🛡️ スマートで安全な検出**\
**アクティブなウィンドウを持たないバックグラウンドの**エクスプローラー プロセスのみを特定して停止します。デスクトップ、タスクバー、および開いているフォルダー ウィンドウを妨害することは**決してありません**。
* **📊 リソース状況に応じたクリーンアップ**\
完全にアイドル状態のプロセスのみを終了します。CPU 使用率とディスク I/O を監視し、ファイル コピーなどの実行中のタスクが中断されないように配慮されています。
* **🚀 軽量 & スタンドアロン**\
最大限の効率を求めて Rust で記述されています。依存関係のない単一の実行ファイルであり、.NET やその他の**ランタイムのインストールは不要です**。
* **⚙️ 高度なカスタマイズ性**\
`config.toml` ファイルを通じて、スキャン間隔や「アイドル」と判定するしきい値（CPU/ディスク）をシステムの環境に合わせて微調整できます。

## 動作要件

* Windows 10 / 11

### 重要

このアプリケーションは、以下の Windows 設定を有効にしているユーザー向けに設計されています:

1. **エクスプローラー**の**オプション**を開きます。
2. **表示**タブに移動します。
3. 「**別のプロセスでフォルダー ウィンドウを開く**」にチェックを入れます。

(注意: この設定がオフの場合、すべてのウィンドウはシステム シェル プロセス内で実行されるため、本アプリは必要ありません。)

## セットアップ (x64)

1. **ダウンロード**: [リリースページ](https://github.com/menndouyukkuri/explorer_ghost_cleaner/releases/latest) から最新の zip ファイルを入手します。
2. **展開**: 任意のフォルダにアーカイブを展開します。
3. **実行**: `explorer_ghost_cleaner.exe` をダブルクリックします。バックグラウンドで実行が始まります。
   * アプリを終了するには、トレイ アイコンを右クリックして **Exit** を選択してください。
   * 管理者権限は必要ありません。

### スタートアップへの登録

Windows の起動時に自動的に実行するには、以下の手順を行ってください:

1. `explorer_ghost_cleaner.exe` を右クリックし、「**ショートカットの作成**」を選択します。
2. エクスプローラーのアドレスバーに `shell:startup` と入力して Enter キーを押します。
3. 作成したショートカットをそのフォルダに移動します。

### アンインストール

アンインストールするには、実行ファイルと設定ファイルを削除するだけです。

`shell:startup` フォルダにショートカットを作成した場合は、それも削除してください。

## 設定

アプリケーションには `config.toml` ファイルが含まれています。任意のテキスト エディタで編集することで動作を調整できます:

```toml
# アイドル プロセスのスキャン間隔 (秒)
interval_seconds = 300 # デフォルト: 300 (5分)

# アイドル判定のしきい値: 使用率が以下の値以下の場合にプロセスを終了します
# CPU 使用率 (%)
cpu_threshold = 1.0 # デフォルト: 1.0
# ディスク I/O バイト
disk_threshold_bytes = 102_400 # デフォルト: 102_400 (100KiB)
```

## ビルド

ソースからビルドする場合は、Rust と Cargo ([Rustup](https://rustup.rs/) でインストール可能) がインストールされていることを確認し、以下のコマンドを実行してください:

```cmd
cargo build --release
```

## ライセンス

**自己責任でご利用ください。**

本ソフトウェアは、以下のライセンスのいずれかの下で利用できます。

* Apache License, Version 2.0 ([LICENSE-APACHE](../LICENSE-APACHE) or https://www.apache.org/licenses/LICENSE-2.0)
* MIT License ([LICENSE-MIT](../LICENSE-MIT) or https://opensource.org/licenses/MIT)

ご都合に合う方を採用してください。
